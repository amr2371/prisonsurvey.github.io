<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/table1-1.0/table1_defaults.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="EDA.html">Exploratory Analysis</a>
</li>
<li>
  <a href="stat_tests.html">Statistical Analysis</a>
</li>
<li>
  <a href="Maps.html">Spatial Analysis</a>
</li>
<li>
  <a href="project_report.html">Project Report</a>
</li>
<li>
  <a href="https://github.com/amr2371/prisonsurvey.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exploratory Data Analysis</h1>

</div>


<p>To conduct our exploratory data analysis, we first imported the
datasets of both state and federally incarcerated individuals from the
<code>Survey of Inmates in State and Federal Correctional Facilities, [United States], 2004 (ICPSR 4572)</code>
into R. We also selected only our variables of interest to pare down
these datasets.</p>
<p>Subsequently, we stacked these two datasets based on a newly created
variable called <code>dataset</code>, which identified whether the
associated observation was from the state or federal file. We also
cleaned this data by recoding some of the factor variables, adding
labels to variables, changing the coding of values from
<code>missing</code> or <code>don't know</code> to NA, etc.</p>
<p>This tidying and cleaning resulted in a combined dataset with
<code>17881</code> rows (observations) and <code>60</code> columns
(variables).</p>
<div id="demographics" class="section level1">
<h1>Demographics</h1>
<p>To examine the distribution of demographic variables across our
dataset, we created a tabular display of variables: <code>sex</code>,
<code>age group</code>, and <code>race/ethnicity</code>.</p>
<div id="distribution-of-demographic-variables-by-mental-health-history"
class="section level3">
<h3>Distribution of Demographic Variables by Mental Health History</h3>
<pre class="r"><code>#Demographics Table
table1(~ V0005 + AGE_CAT + V2982 | MENTAL_HISTORY_BINARY, data = total_df, overall = &quot;Total&quot;)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>No history of mental health condition(s)<br><span class='stratn'>(N=12997)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>History of mental health condition(s)<br><span class='stratn'>(N=4884)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Total<br><span class='stratn'>(N=17881)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>Sex</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Male</td>
<td>10898 (83.9%)</td>
<td>3157 (64.6%)</td>
<td>14055 (78.6%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Female</td>
<td class='lastrow'>2099 (16.1%)</td>
<td class='lastrow'>1727 (35.4%)</td>
<td class='lastrow'>3826 (21.4%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Age Group</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>< 25 yrs</td>
<td>2027 (15.6%)</td>
<td>741 (15.2%)</td>
<td>2768 (15.5%)</td>
</tr>
<tr>
<td class='rowlabel'>25-34</td>
<td>4409 (33.9%)</td>
<td>1552 (31.8%)</td>
<td>5961 (33.3%)</td>
</tr>
<tr>
<td class='rowlabel'>35-44</td>
<td>3930 (30.2%)</td>
<td>1623 (33.2%)</td>
<td>5553 (31.1%)</td>
</tr>
<tr>
<td class='rowlabel'>45-54</td>
<td>1891 (14.5%)</td>
<td>756 (15.5%)</td>
<td>2647 (14.8%)</td>
</tr>
<tr>
<td class='rowlabel'>55-64</td>
<td>597 (4.6%)</td>
<td>182 (3.7%)</td>
<td>779 (4.4%)</td>
</tr>
<tr>
<td class='rowlabel'>65-96</td>
<td>143 (1.1%)</td>
<td>30 (0.6%)</td>
<td>173 (1.0%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Unknown</td>
<td class='lastrow'>0 (0%)</td>
<td class='lastrow'>0 (0%)</td>
<td class='lastrow'>0 (0%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Race/Ethnicity</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>White non-Hispanic</td>
<td>3832 (29.5%)</td>
<td>2456 (50.3%)</td>
<td>6288 (35.2%)</td>
</tr>
<tr>
<td class='rowlabel'>Black non-Hispanic</td>
<td>5691 (43.8%)</td>
<td>1403 (28.7%)</td>
<td>7094 (39.7%)</td>
</tr>
<tr>
<td class='rowlabel'>Hispanic</td>
<td>2727 (21.0%)</td>
<td>647 (13.2%)</td>
<td>3374 (18.9%)</td>
</tr>
<tr>
<td class='rowlabel'>American Indian, Alaska Native non-Hispanic</td>
<td>243 (1.9%)</td>
<td>97 (2.0%)</td>
<td>340 (1.9%)</td>
</tr>
<tr>
<td class='rowlabel'>Asian, Pacific Islander, Native Hawaiian non-Hispanic</td>
<td>162 (1.2%)</td>
<td>34 (0.7%)</td>
<td>196 (1.1%)</td>
</tr>
<tr>
<td class='rowlabel'>Multiple Races reported, non-Hispanic</td>
<td>321 (2.5%)</td>
<td>240 (4.9%)</td>
<td>561 (3.1%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>21 (0.2%)</td>
<td class='lastrow'>7 (0.1%)</td>
<td class='lastrow'>28 (0.2%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="educational-attainment-by-mental-health-history"
class="section level3">
<h3>Educational Attainment by Mental Health History</h3>
<pre class="r"><code>#Bar Graph for EDUCATION
total_df %&gt;% 
  group_by(MENTAL_HISTORY_BINARY, EDUCATION) %&gt;% 
  summarise(n = n()) %&gt;%
  mutate(freq = n / sum(n)) %&gt;%
  rename(MH_History = MENTAL_HISTORY_BINARY) %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = EDUCATION, y = freq, fill = MH_History)) +
  geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="EDA_files/figure-html/edu-1.png" width="100%" /></p>
</div>
<div id="educational-attainment-by-mental-health-history-1"
class="section level3">
<h3>Educational Attainment by Mental Health History</h3>
<pre class="r"><code>#BAR graph for SES_INCOMEMTH
total_df %&gt;% 
  group_by(MENTAL_HISTORY_BINARY, SES_INCOMEMTH) %&gt;% 
  summarise(n = n()) %&gt;%
  mutate(freq = n / sum(n)) %&gt;%
  rename(MH_History = MENTAL_HISTORY_BINARY) %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = SES_INCOMEMTH, y = freq, fill = MH_History)) +
  geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
   labs(x = &quot;Monthly Income in Month Before Arrest&quot;)</code></pre>
<p><img src="EDA_files/figure-html/income-1.png" width="100%" /></p>
</div>
</div>
<div id="incarceration-related-variables" class="section level1">
<h1>Incarceration-Related Variables</h1>
<div
id="distribution-of-incarceration-related-variables-by-mental-health-history"
class="section level3">
<h3>Distribution of Incarceration-Related Variables by Mental Health
History</h3>
<pre class="r"><code>#Incarceration table
table1(~ CH_PRIORSENTENCE_NUM + V1197 + CH_CRIMHIST_COLLAPSED + SES_PARENTS_INCARCERATED + SES_FAMILY_INCARCERATED + dataset | MENTAL_HISTORY_BINARY, data = total_df, overall = &quot;Total&quot;)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>No history of mental health condition(s)<br><span class='stratn'>(N=12997)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>History of mental health condition(s)<br><span class='stratn'>(N=4884)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Total<br><span class='stratn'>(N=17881)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>Number of Prior Sentences</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>No prior sentence</td>
<td>3997 (30.8%)</td>
<td>1297 (26.6%)</td>
<td>5294 (29.6%)</td>
</tr>
<tr>
<td class='rowlabel'>One prior sentence</td>
<td>2048 (15.8%)</td>
<td>687 (14.1%)</td>
<td>2735 (15.3%)</td>
</tr>
<tr>
<td class='rowlabel'>Two prior sentences</td>
<td>1998 (15.4%)</td>
<td>713 (14.6%)</td>
<td>2711 (15.2%)</td>
</tr>
<tr>
<td class='rowlabel'>Three to five prior sentences</td>
<td>2974 (22.9%)</td>
<td>1147 (23.5%)</td>
<td>4121 (23.0%)</td>
</tr>
<tr>
<td class='rowlabel'>Six to ten prior sentences</td>
<td>1302 (10.0%)</td>
<td>635 (13.0%)</td>
<td>1937 (10.8%)</td>
</tr>
<tr>
<td class='rowlabel'>Eleven or more prior sentences</td>
<td>543 (4.2%)</td>
<td>338 (6.9%)</td>
<td>881 (4.9%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>135 (1.0%)</td>
<td class='lastrow'>67 (1.4%)</td>
<td class='lastrow'>202 (1.1%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Number of Prior Arrests</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>4.39 (7.24)</td>
<td>5.45 (8.59)</td>
<td>4.68 (7.64)</td>
</tr>
<tr>
<td class='rowlabel'>Median [Min, Max]</td>
<td>2.00 [0, 99.0]</td>
<td>3.00 [0, 99.0]</td>
<td>2.00 [0, 99.0]</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>535 (4.1%)</td>
<td class='lastrow'>235 (4.8%)</td>
<td class='lastrow'>770 (4.3%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Collapsed Criminal History</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>First timers</td>
<td>4340 (33.4%)</td>
<td>1419 (29.1%)</td>
<td>5759 (32.2%)</td>
</tr>
<tr>
<td class='rowlabel'>Recidivist, current or past violent offense</td>
<td>4676 (36.0%)</td>
<td>2034 (41.6%)</td>
<td>6710 (37.5%)</td>
</tr>
<tr>
<td class='rowlabel'>Recidivist, no current or prior violent offense</td>
<td>3920 (30.2%)</td>
<td>1416 (29.0%)</td>
<td>5336 (29.8%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>61 (0.5%)</td>
<td class='lastrow'>15 (0.3%)</td>
<td class='lastrow'>76 (0.4%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Parents Been Incarcerated</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Yes</td>
<td>2310 (17.8%)</td>
<td>1195 (24.5%)</td>
<td>3505 (19.6%)</td>
</tr>
<tr>
<td class='rowlabel'>No</td>
<td>10534 (81.0%)</td>
<td>3625 (74.2%)</td>
<td>14159 (79.2%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>153 (1.2%)</td>
<td class='lastrow'>64 (1.3%)</td>
<td class='lastrow'>217 (1.2%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Children, Siblings, or Spouse Been Incarcerated</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Yes</td>
<td>4737 (36.4%)</td>
<td>1991 (40.8%)</td>
<td>6728 (37.6%)</td>
</tr>
<tr>
<td class='rowlabel'>No</td>
<td>8118 (62.5%)</td>
<td>2836 (58.1%)</td>
<td>10954 (61.3%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>142 (1.1%)</td>
<td class='lastrow'>57 (1.2%)</td>
<td class='lastrow'>199 (1.1%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Dataset</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Federal</td>
<td>2829 (21.8%)</td>
<td>760 (15.6%)</td>
<td>3589 (20.1%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>State</td>
<td class='lastrow'>10168 (78.2%)</td>
<td class='lastrow'>4124 (84.4%)</td>
<td class='lastrow'>14292 (79.9%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="type-of-offense-by-mental-health-history"
class="section level3">
<h3>Type of Offense by Mental Health History</h3>
<pre class="r"><code>#Bar graph fir TYPEOFOFFENSE
total_df %&gt;% 
  group_by(MENTAL_HISTORY_BINARY, TYPEOFFENSE) %&gt;% 
  summarise(n = n()) %&gt;%
  mutate(freq = n / sum(n)) %&gt;%
  mutate(
    TYPEOFFENSE = gsub(&quot;.*)&quot;, &quot;&quot;, TYPEOFFENSE), 
    TYPEOFFENSE = fct_reorder(TYPEOFFENSE, -freq)) %&gt;% 
  rename(MH_History = MENTAL_HISTORY_BINARY) %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = TYPEOFFENSE, y = freq, fill = MH_History)) +
  geom_col(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
   labs(x = &quot;Type of Offense&quot;)</code></pre>
<p><img src="EDA_files/figure-html/offense-1.png" width="100%" /></p>
<pre class="r"><code>#Density plot for V1197
ggplot(data = total_df, aes(x = V1197)) +
  geom_density(aes(color = MENTAL_HISTORY_BINARY)) +
  labs(x = &quot;Number of Prior Arrests&quot;)</code></pre>
<p><img src="EDA_files/figure-html/prior_arrests-1.png" width="100%" /></p>
</div>
</div>
<div id="mental-health" class="section level1">
<h1>Mental Health</h1>
<div id="ever-taken-medication" class="section level3">
<h3>Ever Taken Medication</h3>
<pre class="r"><code>#Bar graph for ever taken mental health medication

total_df %&gt;% 
  filter(V2409 == &quot;Yes&quot; | V2409 == &quot;No&quot;) %&gt;%
  group_by(V2409) %&gt;% 
  summarize(count = n()) %&gt;% 
   mutate(
    V2409 = fct_reorder(V2409, count)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(aes(x = V2409, y = count, fill = &quot;purple&quot;)) +
  geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(legend.position = &quot;none&quot;) +
  labs(x = &quot;Ever taken medication for mental health&quot;) </code></pre>
<p><img src="EDA_files/figure-html/meds_ever-1.png" width="100%" /></p>
</div>
<div id="taken-medication-since-admission" class="section level3">
<h3>Taken Medication Since Admission</h3>
<pre class="r"><code>#Bar graph for taken mental health medication since admission

total_df %&gt;% 
  filter(V2412 == &quot;Yes&quot; | V2412 == &quot;No&quot;) %&gt;% 
  group_by(V2412) %&gt;% 
  summarize(count = n()) %&gt;% 
   mutate(
    V2412 = fct_reorder(V2412, count)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(aes(x = V2412, y = count, fill = &quot;purple&quot;)) +
  geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(legend.position = &quot;none&quot;) +
  labs(x = &quot;Taken medication for mental health since admission&quot;) </code></pre>
<p><img src="EDA_files/figure-html/meds_admission-1.png" width="100%" /></p>
</div>
<div id="mental-health-hospitalization-in-year-before-arrest"
class="section level3">
<h3>Mental Health Hospitalization in Year Before Arrest</h3>
<pre class="r"><code># Bar graph of MCMH_MHOSPYR

total_df %&gt;% 
  group_by(MCMH_MHOSPYR) %&gt;% 
  summarize(count = n()) %&gt;% 
  drop_na() %&gt;% 
  mutate(MCMH_MHOSPYR = fct_reorder(MCMH_MHOSPYR, count)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(aes(x = MCMH_MHOSPYR, y = count, fill = &quot;purple&quot;)) +
  geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  theme(legend.position = &quot;none&quot;) +
  labs(x = &quot;Hospitalized for mental health, in year before arrest&quot;) </code></pre>
<p><img src="EDA_files/figure-html/hosp_year-1.png" width="100%" /></p>
</div>
<div id="mental-health-hospitalization-since-admission"
class="section level3">
<h3>Mental Health Hospitalization Since Admission</h3>
<pre class="r"><code># Bar graph of MCMH_MHOSPADM

total_df %&gt;% 
  group_by(MCMH_MHOSPADM) %&gt;% 
  summarize(count = n()) %&gt;% 
  drop_na() %&gt;% 
  mutate(MCMH_MHOSPADM = fct_reorder(MCMH_MHOSPADM, count)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(aes(x = MCMH_MHOSPADM, y = count, fill = &quot;purple&quot;)) +
  geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  theme(legend.position = &quot;none&quot;) +
  labs(x = &quot;Hospitalized for mental health, since admission&quot;) </code></pre>
<p><img src="EDA_files/figure-html/hosp_admission-1.png" width="100%" /></p>
</div>
<div
id="treatment-continuation-one-year-prior-to-arrest-and-since-admission"
class="section level3">
<h3>Treatment Continuation (one year prior to arrest and since
admission)</h3>
<pre class="r"><code># Line graph for MH treatment continuation (one year prior to arrest and since admission)

state_tx = state_df %&gt;%
  group_by(MCMH_MH_TREATMENT_PA, MCMH_MH_TREATMENT_AD) %&gt;%
  summarize(n_obs = n()) %&gt;%
  mutate(
    MCMH_MH_TREATMENT_PA = gsub(&quot;.* &quot;, &quot;&quot;, MCMH_MH_TREATMENT_PA),
    MCMH_MH_TREATMENT_AD = gsub(&quot;.* &quot;, &quot;&quot;, MCMH_MH_TREATMENT_AD),
    tx_pa_ad = str_c(MCMH_MH_TREATMENT_PA, &#39;/&#39;,MCMH_MH_TREATMENT_AD)
  ) %&gt;%
  ungroup() %&gt;%
  mutate(
    sum = sum(n_obs),
    percent = (n_obs/sum) * 100 ) 

federal_tx = federal_df %&gt;%
  group_by(MCMH_MH_TREATMENT_PA, MCMH_MH_TREATMENT_AD) %&gt;%
  summarize(n_obs = n()) %&gt;%
  mutate(
    MCMH_MH_TREATMENT_PA = gsub(&quot;.* &quot;, &quot;&quot;, MCMH_MH_TREATMENT_PA),
    MCMH_MH_TREATMENT_AD = gsub(&quot;.* &quot;, &quot;&quot;, MCMH_MH_TREATMENT_AD),
    tx_pa_ad = str_c(MCMH_MH_TREATMENT_PA, &#39;/&#39;,MCMH_MH_TREATMENT_AD)
  ) %&gt;%
  ungroup() %&gt;%
  mutate(
    sum = sum(n_obs),
    percent = (n_obs/sum) * 100 ) 

colors &lt;- c(&quot;State Prisons&quot; = &quot;blue&quot;, &quot;Federal Prisons&quot; = &quot;red&quot;)
ggplot() + 
  geom_line(data = state_tx, aes(x = tx_pa_ad, y = percent, group = 1, color = &quot;State Prisons&quot;)) + 
  geom_line(data = federal_tx, aes(x = tx_pa_ad, y = percent, group = 1, color = &quot;Federal Prisons&quot;)) +
  labs(
    x = &quot;1 Year Prior to Arrest/Since Admission&quot;,
    y = &quot;Percent (%) of Survey Respondents&quot;,
    color = &quot;&quot;
  ) +
  scale_color_manual(values = colors)</code></pre>
<p><img src="EDA_files/figure-html/trt-1.png" width="100%" /></p>
</div>
</div>
<div id="hiv-status-by-mental-health-history" class="section level1">
<h1>HIV Status by Mental Health History</h1>
<pre class="r"><code>table1(~ MCMH_RSLT_HIV | MENTAL_HISTORY_BINARY, data = total_df, overall = &quot;Total&quot;)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>No history of mental health condition(s)<br><span class='stratn'>(N=12997)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>History of mental health condition(s)<br><span class='stratn'>(N=4884)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Total<br><span class='stratn'>(N=17881)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>HIV Status</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Positive</td>
<td>144 (1.1%)</td>
<td>84 (1.7%)</td>
<td>228 (1.3%)</td>
</tr>
<tr>
<td class='rowlabel'>Presumed Negative</td>
<td>10276 (79.1%)</td>
<td>3976 (81.4%)</td>
<td>14252 (79.7%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>2577 (19.8%)</td>
<td class='lastrow'>824 (16.9%)</td>
<td class='lastrow'>3401 (19.0%)</td>
</tr>
</tbody>
</table>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
